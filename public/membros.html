<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Membros de Associação dos Filhos e Amigos de Luanda - Bolama</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="menb.css" />
  <link rel="icon" href="img/luand.png" type="image/png">


</head>
<body>

<header>
  <img src="./img/luand.png" alt="logotipo" />
  <h1>Registo de Membros</h1>
</header>

<nav>
  <a href="index.html">MISSÃO</a>
  <a href="quota.html">QUOTA</a>
  <a href="membros.html">MEMBROS</a>
  <a href="estatuto.html">ESTATUTO</a>
  <a href="metas.html">META</a>
</nav>

<form id="formMembro" enctype="multipart/form-data">
  <legend>Preenche o Formulário</legend>

  <label>Nome:</label>
  <input type="text" name="nome" required />

  <label>Email:</label>
  <input type="email" name="email" required />

  <label>Cargo:</label>
  <input type="text" name="cargo" />

  <label>País:</label>
  <select name="pais" required>
    <option value="">---- selecione ----</option>
    <option value="Guiné-Bissau">Guiné-Bissau</option>
    <option value="Senegal">Senegal</option>
    <option value="Gambia">Gambia</option>
    <option value="Portugal">Portugal</option>
    <option value="França">França</option>
    <option value="Espanha">Espanha</option>
    <option value="Holanda">Holanda</option>
    <option value="Belgica">Belgica</option>
    <option value="Brasil">Brasil</option>
    <option value="América">América</option>
  </select>

  <label>Telefone:</label>
  <input type="text" name="telefone" required />

  <label>Foto:</label>
  <input type="file" name="foto" accept="image/*" required />

  <button type="submit">Adicionar Membro</button>
</form>

<section class="membros-lista" id="listaMembros"></section>

<!-- MODAL -->
<div id="modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.6); align-items:center; justify-content:center;">
  <div style="background:#fff; padding:20px; border-radius:10px; width:350px;">
    <h3>Editar Membro</h3>
    <form id="formEditar">
      <input type="hidden" id="editId" />

      <label>Nome:</label>
      <input type="text" id="editNome" required />

      <label>Email:</label>
      <input type="email" id="editEmail" required />

      <label>Cargo:</label>
      <input type="text" id="editCargo" />

      <label>País:</label>
      <input type="text" id="editPais" required />

      <label>Telefone:</label>
      <input type="text" id="editTelefone" required />

      <button type="submit">Guardar</button>
      <button type="button" onclick="fecharModal()">Cancelar</button>
    </form>
  </div>
</div>
<script>
const BACKEND_URL = "https://associacaoafalb-4.onrender.com";

const form = document.getElementById("formMembro");
const lista = document.getElementById("listaMembros");

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  const formData = new FormData(form);

  try {
    const res = await fetch(`${BACKEND_URL}/api/membros`, {
      method: "POST",
      body: formData
    });

    const data = await res.json();
    console.log("RESPOSTA DO BACKEND:", data);

    alert("Membro cadastrado com sucesso!");
    form.reset();
    carregarMembros();

  } catch (err) {
    console.error("Erro no envio:", err);
    alert("Erro ao cadastrar!");
  }
});


async function carregarMembros() {
  try {
    const res = await fetch(`${BACKEND_URL}/api/membros`);
    const membros = await res.json();

    console.log("MEMBROS RECEBIDOS:", membros);

    lista.innerHTML = membros.map(m => `
      <div class="membro">
        <img src="${m.foto}" width="100"/>
        <h3>${m.nome}</h3>
        <p>${m.email}</p>
        <p>${m.pais}</p>
        <p>${m.telefone}</p>
      </div>
    `).join("");

  } catch (err) {
    console.error("Erro ao carregar membros:", err);
  }
}

carregarMembros();
</script>

<footer>
  <p>&copy; 2025 Associação dos Filhos e Amigos de Luanda Bolama</p>
</footer>

v
</body>
</html>
